---
// Standalone unsubscribe page - no BaseLayout
---
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>הסרה מרשימת תפוצה | Focus AI</title>
  <meta name="robots" content="noindex, nofollow" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    html { zoom: 1 !important; }
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Heebo', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #1a0a2e 0%, #0f0f1a 40%, #1a0a2e 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      direction: rtl;
    }

    .container {
      background: rgba(255,255,255,0.04);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(168,85,247,0.2);
      border-radius: 24px;
      padding: 48px 40px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 40px rgba(168,85,247,0.08);
    }

    .logo {
      text-align: center;
      margin-bottom: 28px;
    }
    .logo img {
      max-width: 140px;
      height: auto;
    }

    h1 {
      font-size: 26px;
      font-weight: 700;
      text-align: center;
      color: #fff;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .subtitle {
      text-align: center;
      color: rgba(255,255,255,0.55);
      font-size: 15px;
      margin-bottom: 32px;
      line-height: 1.6;
    }

    .form-group { margin-bottom: 20px; }

    label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: rgba(255,255,255,0.8);
      margin-bottom: 8px;
    }

    input[type="email"],
    input[type="tel"] {
      width: 100%;
      padding: 14px 16px;
      font-size: 16px;
      font-family: inherit;
      border: 1.5px solid rgba(255,255,255,0.12);
      border-radius: 12px;
      background: rgba(255,255,255,0.06);
      color: #fff;
      transition: all 0.25s ease;
      direction: ltr;
      text-align: right;
    }
    input[type="email"]::placeholder,
    input[type="tel"]::placeholder { color: rgba(255,255,255,0.3); direction: ltr; }

    input[type="email"]:focus,
    input[type="tel"]:focus {
      outline: none;
      border-color: rgba(168,85,247,0.6);
      background: rgba(168,85,247,0.08);
    }
    input.invalid { border-color: #ef4444; background: rgba(239,68,68,0.08); }
    input.valid   { border-color: #22c55e; background: rgba(34,197,94,0.06); }

    .field-error   { font-size: 13px; color: #f87171; margin-top: 5px; display: none; }
    .field-success { font-size: 13px; color: #4ade80; margin-top: 5px; display: none; }
    .field-error.show, .field-success.show { display: block; }

    .form-note {
      font-size: 12px;
      color: rgba(255,255,255,0.35);
      margin-top: 6px;
      line-height: 1.4;
    }

    .btn-primary {
      width: 100%;
      padding: 16px;
      font-size: 16px;
      font-weight: 600;
      font-family: inherit;
      color: white;
      background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.25s ease;
      margin-bottom: 12px;
    }
    .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); box-shadow: 0 8px 24px rgba(168,85,247,0.4); }
    .btn-primary:active { transform: translateY(0); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    .btn-secondary {
      width: 100%;
      padding: 16px;
      font-size: 16px;
      font-weight: 600;
      font-family: inherit;
      color: rgba(255,255,255,0.6);
      background: rgba(255,255,255,0.06);
      border: 1.5px solid rgba(255,255,255,0.12);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.25s ease;
    }
    .btn-secondary:hover { background: rgba(255,255,255,0.1); color: #fff; }

    .divider { height: 1px; background: rgba(255,255,255,0.08); margin: 24px 0; }

    .contact-info {
      text-align: center;
      font-size: 13px;
      color: rgba(255,255,255,0.4);
    }
    .contact-info a { color: #c084fc; text-decoration: none; font-weight: 600; }
    .contact-info a:hover { text-decoration: underline; }

    .error-message {
      display: none;
      background: rgba(239,68,68,0.1);
      border: 1px solid rgba(239,68,68,0.3);
      color: #f87171;
      padding: 12px 16px;
      border-radius: 10px;
      margin-bottom: 16px;
      font-size: 14px;
    }
    .error-message.show { display: block; }

    .success-message {
      display: none;
      text-align: center;
      padding: 20px 0;
    }
    .success-message.show { display: block; }

    .success-icon {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, #a855f7, #ec4899);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 28px;
    }
    .success-message h2 {
      font-size: 22px;
      color: #fff;
      margin-bottom: 12px;
      font-weight: 700;
    }
    .success-message p {
      color: rgba(255,255,255,0.6);
      font-size: 15px;
      line-height: 1.7;
    }

    @media (max-width: 480px) {
      .container { padding: 32px 20px; }
      h1 { font-size: 22px; }
    }
  </style>
</head>
<body>
  <div class="container">

    <div id="formContent">
      <div class="logo">
        <img src="https://res.cloudinary.com/dfudxxzlj/image/upload/q_auto,f_auto,w_200/v1765265415/2_fxdcio.png" alt="Focus AI" />
      </div>

      <h1>אנחנו מצטערים לראות אותך עוזב/ת</h1>
      <p class="subtitle">
        האם את/ה בטוח/ה שברצונך להסיר את עצמך מרשימת הדיוור של Focus AI?
      </p>

      <div class="error-message" id="errorMessage"></div>

      <form id="unsubscribeForm">
        <div class="form-group">
          <label for="email">כתובת אימייל</label>
          <input type="email" id="email" name="email" placeholder="your@email.com" />
          <div class="field-error" id="emailError">אימייל לא תקין</div>
          <div class="field-success" id="emailSuccess">✓ אימייל תקין</div>
          <div class="form-note">הזן/י את כתובת המייל שרשומה במערכת (לפחות שדה אחד חובה)</div>
        </div>

        <div class="form-group">
          <label for="phone">מספר טלפון</label>
          <input type="tel" id="phone" name="phone" placeholder="05X-XXXXXXX" />
          <div class="field-error" id="phoneError">מספר טלפון לא תקין</div>
          <div class="field-success" id="phoneSuccess">✓ טלפון תקין</div>
          <div class="form-note">הזן/י את מספר הטלפון שרשום במערכת</div>
        </div>

        <button type="submit" class="btn-primary" id="submitBtn">
          כן, הסר/י אותי מרשימת הדיוור
        </button>
        <button type="button" class="btn-secondary" onclick="window.history.back()">
          לא, אני רוצה להישאר
        </button>
      </form>

      <div class="divider"></div>
      <div class="contact-info">
        לשאלות נוספות: <a href="mailto:office@focusai.co.il">office@focusai.co.il</a>
      </div>
    </div>

    <div id="successMessage" class="success-message">
      <div class="success-icon">✓</div>
      <h2>בקשתך התקבלה בהצלחה</h2>
      <p>
        הסרנו אותך מרשימת התפוצה שלנו.<br />
        לא תקבל/י מאיתנו עוד הודעות שיווקיות.<br /><br />
        אם תרצה/י לחזור אלינו בעתיד, נשמח לקבל אותך בחזרה.
      </p>
    </div>

  </div>

  <script>
    const form = document.getElementById('unsubscribeForm');
    const submitBtn = document.getElementById('submitBtn');
    const errorMessage = document.getElementById('errorMessage');
    const formContent = document.getElementById('formContent');
    const successMessage = document.getElementById('successMessage');

    const emailInput = document.getElementById('email');
    const phoneInput = document.getElementById('phone');
    const emailError = document.getElementById('emailError');
    const emailSuccess = document.getElementById('emailSuccess');
    const phoneError = document.getElementById('phoneError');
    const phoneSuccess = document.getElementById('phoneSuccess');

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const phoneRegex = /^0(5[0-9]|[2-4]|[8-9])[0-9]{7,8}$/;

    emailInput.addEventListener('input', function(e) {
      const value = e.target.value.trim();
      if (value === '') {
        emailInput.classList.remove('invalid', 'valid');
        emailError.classList.remove('show');
        emailSuccess.classList.remove('show');
      } else if (emailRegex.test(value)) {
        emailInput.classList.replace('invalid', 'valid') || emailInput.classList.add('valid');
        emailError.classList.remove('show');
        emailSuccess.classList.add('show');
      } else {
        emailInput.classList.replace('valid', 'invalid') || emailInput.classList.add('invalid');
        emailSuccess.classList.remove('show');
        emailError.classList.add('show');
      }
    });

    phoneInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 10) value = value.slice(0, 10);
      if (value.length > 3) value = value.slice(0, 3) + '-' + value.slice(3);
      e.target.value = value;

      const clean = value.replace(/[-\s]/g, '');
      if (clean === '') {
        phoneInput.classList.remove('invalid', 'valid');
        phoneError.classList.remove('show');
        phoneSuccess.classList.remove('show');
      } else if (phoneRegex.test(clean)) {
        phoneInput.classList.replace('invalid', 'valid') || phoneInput.classList.add('valid');
        phoneError.classList.remove('show');
        phoneSuccess.classList.add('show');
      } else {
        phoneInput.classList.replace('valid', 'invalid') || phoneInput.classList.add('invalid');
        phoneSuccess.classList.remove('show');
        phoneError.classList.add('show');
      }
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorMessage.textContent = '';
      errorMessage.classList.remove('show');

      const email = emailInput.value.trim();
      const phone = phoneInput.value.trim();

      if (!email && !phone) {
        errorMessage.textContent = 'אנא מלא/י לפחות שדה אחד (אימייל או טלפון)';
        errorMessage.classList.add('show');
        return;
      }
      if (email && !emailRegex.test(email)) {
        errorMessage.textContent = 'אנא הזן/י כתובת אימייל תקינה';
        errorMessage.classList.add('show');
        return;
      }

      let cleanPhone = '';
      if (phone) {
        cleanPhone = phone.replace(/[-\s]/g, '');
        if (!phoneRegex.test(cleanPhone)) {
          errorMessage.textContent = 'אנא הזן/י מספר טלפון ישראלי תקין';
          errorMessage.classList.add('show');
          return;
        }
      }

      submitBtn.disabled = true;
      submitBtn.textContent = 'שולח...';

      try {
        const response = await fetch('https://focus2025.app.n8n.cloud/webhook/8422a522-cfc0-4e23-959d-24bd6c7152be', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email: email || null,
            phone: cleanPhone || null,
            timestamp: new Date().toISOString(),
            action: 'unsubscribe'
          })
        });

        if (response.ok) {
          formContent.style.display = 'none';
          successMessage.classList.add('show');
        } else {
          throw new Error('Server error');
        }
      } catch (error) {
        errorMessage.textContent = 'אירעה שגיאה בשליחת הבקשה. אנא נסה/י שוב או פנה/י אלינו ישירות במייל.';
        errorMessage.classList.add('show');
        submitBtn.disabled = false;
        submitBtn.textContent = 'כן, הסר/י אותי מרשימת הדיוור';
      }
    });
  </script>
</body>
</html>
